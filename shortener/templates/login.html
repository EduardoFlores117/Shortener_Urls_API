<html>
  <head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link rel="stylesheet" as="style" onload="this.rel='stylesheet'" href="https://fonts.googleapis.com/css2?display=swap&amp;family=Inter%3Awght%40400%3B500%3B700%3B900&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900" />

    <title>Acortador URL</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  </head>
  <body>
    <div
      class="relative flex size-full min-h-screen flex-col bg-[#111a22] dark group/design-root overflow-x-hidden"
      style="--checkbox-tick-svg: url('data:image/svg+xml,%3csvg viewBox=%270 0 16 16%27 fill=%27rgb(255,255,255)%27 xmlns=%27http://www.w3.org/2000/svg%27%3e%3cpath d=%27M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z%27/%3e%3c/svg%3e'); font-family: Inter, &quot;Noto Sans&quot;, sans-serif;">
      <div class="layout-container flex h-full grow flex-col">
        <header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#243647] px-10 py-3">
          <div class="flex items-center gap-4 text-white">
            <div class="size-4">
              <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M36.7273 44C33.9891 44 31.6043 39.8386 30.3636 33.69C29.123 39.8386 26.7382 44 24 44C21.2618 44 18.877 39.8386 17.6364 33.69C16.3957 39.8386 14.0109 44 11.2727 44C7.25611 44 4 35.0457 4 24C4 12.9543 7.25611 4 11.2727 4C14.0109 4 16.3957 8.16144 17.6364 14.31C18.877 8.16144 21.2618 4 24 4C26.7382 4 29.123 8.16144 30.3636 14.31C31.6043 8.16144 33.9891 4 36.7273 4C40.7439 4 44 12.9543 44 24C44 35.0457 40.7439 44 36.7273 44Z"
                  fill="currentColor"></path>
              </svg>
            </div>
            <h2 class="text-white text-lg font-bold leading-tight tracking-[-0.015em]">Trakr</h2>
          </div>
          <div class="flex flex-1 justify-end gap-8">
            <div class="flex items-center gap-9">
              <a class="text-white text-sm font-medium leading-normal" href="#">Features</a>
              <a class="text-white text-sm font-medium leading-normal" href="#">Pricing</a>
              <a class="text-white text-sm font-medium leading-normal" href="#">Resources</a>
            </div>
            <div class="flex gap-2">
              <button
                class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-10 px-4 bg-[#1980e6] text-white text-sm font-bold leading-normal tracking-[0.015em]">
                <span class="truncate">Sign in</span>
              </button>
              <button
                class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-10 px-4 bg-[#243647] text-white text-sm font-bold leading-normal tracking-[0.015em]">
                <span class="truncate">Get started</span>
              </button>
            </div>
          </div>
        </header>
    <div class="relative flex size-full min-h-screen flex-col bg-[#111a22] dark group/design-root overflow-x-hidden" style="font-family: Inter, 'Noto Sans', sans-serif;">
      <div class="layout-container flex h-full grow flex-col">
        <div class="px-40 flex flex-1 justify-center py-5">
          <div class="layout-content-container flex flex-col w-[512px] max-w-[512px] py-5 flex-1">
            <h1 class="text-white text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 text-left pb-3 pt-5">Sign in to Trakr</h1>
            <div class="flex justify-center">
              <div class="flex flex-1 gap-3 max-w-[480px] flex-col items-stretch px-4 py-3">
                <button class="flex w-full cursor-pointer items-center justify-center rounded-xl h-10 px-4 bg-[#243647] text-white text-sm font-bold">Sign in with Google</button>
                <button class="flex w-full cursor-pointer items-center justify-center rounded-xl h-10 px-4 bg-[#243647] text-white text-sm font-bold">Sign in with GitHub</button>
              </div>
            </div>  
            <p class="text-[#93adc8] text-sm font-normal leading-normal pb-3 pt-1 px-4 text-center">or</p>
            
            <form id="loginForm" action="/auth/login/" method="POST">
              {% csrf_token %}
              <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
                  <label class="flex flex-col min-w-40 flex-1 text-white text-base font-medium leading-normal pb-2">Email address</label>
                  <input name="email" type="email" placeholder="johndoe@gmail.com" class="form-input w-full rounded-xl text-white border border-[#344d65] bg-[#1a2632] h-14 p-[15px]" />
              </div>
              <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
                  <div class="flex flex-col min-w-40 flex-1 relative">
                      <label class="text-white text-base font-medium leading-normal pb-2">Password</label>
                      <input name="password" type="password" placeholder="********" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-white focus:outline-0 focus:ring-0 border border-[#344d65] bg-[#1a2632] focus:border-[#344d65] h-14 placeholder:text-[#93adc8] p-[15px] text-base font-normal leading-normal" />
                  </div>
              </div>
              <div class="px-4 py-3">
                  <button type="submit" class="flex w-full cursor-pointer items-center justify-center rounded-xl h-10 px-4 bg-[#1980e6] text-white text-sm font-bold">Sign in</button>
              </div>
          </form>
    <p class="text-[#93adc8] text-sm text-center pb-3"><a href="#" class="underline">Forgot your password?</a></p>
              <p class="text-[#93adc8] text-sm text-center pb-3"><a href="/auth/registers/" class="underline">Don't have an account?</a></p>
              <p id="errorMessage" class="text-red-500 text-sm text-center hidden"></p>
            </form>
          </div>
        </div>
      </div>
    </div>
    <script>
      document.getElementById('togglePassword').addEventListener('click', function () {
          const passwordInput = document.getElementById('password');
          if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            this.textContent = 'üôà'; // Cambia el icono
          } else {
            passwordInput.type = 'password';
            this.textContent = 'üëÅÔ∏è'; // Cambia el icono
          }
      });
  
      document.getElementById('loginForm').addEventListener('submit', async function (e) {
          e.preventDefault();
          
          const email = document.getElementById('username').value; // Cambi√© username por email
          const password = document.getElementById('password').value;
          const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]')?.value; // CSRF Token de Django
  
          try {
              const response = await fetch('/login/api/', {
                  method: 'POST',
                  headers: { 
                      'Content-Type': 'application/json',
                      'X-CSRFToken': csrftoken // CSRF Token para Django
                  },
                  body: JSON.stringify({ email, password }) // Cambi√© username por email
              });
  
              if (response.ok) {
                  const data = await response.json();
                  localStorage.setItem('accessToken', data.access);
                  localStorage.setItem('isSuperuser', data.is_superuser);
                  window.location.href = data.is_superuser ? '/dashboard/admin' : '/dashboard/user';
              } else {
                  throw new Error('Usuario o contrase√±a incorrectos');
              }
          } catch (error) {
              document.getElementById('errorMessage').classList.remove('hidden');
              document.getElementById('errorMessage').textContent = error.message;
          }
      });
  </script>  
  </body>
</html>

